#textdomain wesnoth-A_Song_of_Fire
[scenario]
    id=35_Wrath_Of_The_Heavens
    name= _ "Wrath of the Heavens"
    map_data="{~add-ons/A_Song_of_Fire/maps/35_Wrath_Of_The_Heavens.map}"
    turns=-1
    {STORMY_SKY_SACRED}
    victory_when_enemies_defeated=no
    next_scenario=36_A_New_Legend_Rises

    {SCENARIO_MUSIC battlecry.ogg}
    {EXTRA_SCENARIO_MUSIC heroes_rite.ogg}
    {EXTRA_SCENARIO_MUSIC ambuscade.ogg}
    {EXTRA_SCENARIO_MUSIC dark_passage.ogg}
    {EXTRA_SCENARIO_MUSIC gathering_storm.ogg}
    {EXTRA_SCENARIO_MUSIC legends_of_the_north.ogg}

    [event]
        name=prestart
        [objectives]
            side=1
            [objective]
                description= _ "Wait for Grigorius to rise"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Myra"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Jevyan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Alenya"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Dvalin"
                condition=lose
            [/objective]
            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]
        [/objectives]
    [/event]

    {WRATH_OF_THE_HEAVENS_STORY}
    {STARTING_VILLAGES 1 8}
    {STARTING_VILLAGES 2 30}

    [side]
        {MYRA}
        recruit=Ethereal Wisp,Brazier Imp,Furnace Beast,Sylph,Zephyr,Tidal,Ice Crab,Vine Beast,Vine Tiger,Kobold,Stone Golem,Razorbird,Thunderbird,Undine
        {GOLD 400 360 320}
        team_name=windsong
        user_team_name=_"Maat'Kare"
        {INCOME 20 15 10}
        {FLAG_VARIANT long}
    [/side]

    [side]
        no_leader=yes
        side=2
        canrecruit=yes
        recruit=Mystic,Claimant,Militant,Divine Knight,Protector,Keeper,Lantern Archon,Prophet,Celestial Herald,Sicarius,Divine Champion,Holy Sentinel,Sentinel,Master of Light
        gold=0
        income=0
        team_name=celestials
        user_team_name=_"Crystal Tower"
        [ai]
            recruitment_pattern=fighter,fighter,fighter,mixed fighter,mixed fighter,archer
            passive_leader=yes
            caution=0.65
            aggression=0.35
        [/ai]
        {FLAG_VARIANT wood-elvish}
    [/side]

    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Prophet) 2}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Celestial Herald) 4}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Divine Champion) 2}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Sicarius) 4}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Holy Sentinel) 3}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Sentinel) 2}
    {LIMIT_CONTEMPORANEOUS_RECRUITS 2 (Master of Light) 3}

    [event]
        name=prestart

        [recall]
            id=Jevyan
            x=24
            y=4
        [/recall]

        [unstore_unit]
            variable=alenya8_store
            x=22
            y=4
        [/unstore_unit]
        {CLEAR_VARIABLE alenya8_store}

        [recall]
            id=Dvalin
            x=22
            y=3
        [/recall]

        [heal_unit]
            [filter]
                side=1
            [/filter]
            amount=full
            moves=full
            restore_attacks=yes
            restore_statuses=yes
        [/heal_unit]

        {GENERIC_UNIT 2 (Celestial Herald) 22 21} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 26 21} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 24 25} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 28 27} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 20 27} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 24 29} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 20 31} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 28 31} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 20 35} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 28 35} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 24 37} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 22 41} {GUARDIAN}
        {GENERIC_UNIT 2 (Celestial Herald) 26 41} {GUARDIAN}

        {SCATTER_GUARDIAN 10 "Divine Champion" 1 "Ccry,Kcry,Dd,Rrc,Rd" 14-34 21-40 2 ()}
        {SCATTER_GUARDIAN 10 "Holy Sentinel" 1 "Ccry,Kcry,Dd,Rrc,Rd" 14-34 21-40 2 ()}
        {SCATTER_GUARDIAN 10 "Prophet" 1 "Ccry,Kcry,Dd,Rrc,Rd" 14-34 21-40 2 ()}
        {SCATTER_GUARDIAN 8 "Sage" 1 "Ccry,Kcry,Dd,Rrc,Rd" 14-34 21-40 2 ()}
        {SCATTER_GUARDIAN 8 "Sicarius" 1 "Ccry,Kcry,Dd,Rrc,Rd" 14-34 21-40 2 ()}
        {SCATTER_GUARDIAN 9 "Sicarius" 1 "Dd,Hd,Rd" 16-32 14-18 2 ()}
    [/event]

    [event]
        name=start

        [role]
            type=Celestial Herald,Sage,Divine Champion,Holy Sentinel,Prophet
            role=Celestial
        [/role]

        [message]
            role=Celestial
            message= _ "Behold, the heretics have saved us the effort of hunting them down, and willingly came to their doom!"
        [/message]
        [message]
            speaker=Alenya
            message= _ "Frankly, I've just had enough of their stupid arrogance!"
        [/message]
        [message]
            speaker=Jevyan
            message= _ "You're not the only one..."
        [/message]
        [message]
            speaker=Myra
            message= _ "Yes, we have come, but to fight your coward of a leader, since he fled from the battlefield before I could reach him last time we met! Tell me, where is he now? Why doesn't he leave his high throne and come fight me himself?"
        [/message]
        [message]
            role=Celestial
            message= _ "Lord Grigorius is busy with more concerning matters, heretic, and has commissioned us to wave thee aside!"
        [/message]
        [message]
            speaker=Myra
            message= _ "Seems like he's chosen you as fodder, to wear us out... I just wonder, has he told you what he has done with the other Lords?"
        [/message]
        [message]
            role=Celestial
            message= _ "Be thou silent, o viper! Lord Grigorius has told us already of how your vile arts have contaminated our dear Lords! Even Lord Grigorius himself believes that, weren't he so wise and experienced, he would have fallen prey to thee as well!"
        [/message]
        [message]
            speaker=Myra
            message= _ "I see there is really no arguing with you... Very well, if you refuse to listen to the language of reason, then I shall use the language of steel!"
        [/message]
        [message]
            speaker=Dvalin
            message= _ "That's it, my friend! Now, let's begin this fight at once, that my arm is itching to let my axe fall on these bird bastards!"
        [/message]
        [message]
            speaker=Myra
            message= _ "Windsong, charge! Today we shall avenge Akashia!"
        [/message]
    [/event]

    [event]
        name=attack
        [filter]
            side=1
        [/filter]
        [filter_second]
            type=Sicarius
        [/filter_second]
        [role]
            type=Sicarius
            role=Vanguard
        [/role]

        [message]
            role=Vanguard
            message= _ "We have been given the honour of spilling your dirty blood before all others, sinners! You shall not reach the citadel's holy walls unscathed!"
        [/message]
    [/event]

    [event]
        name=turn 3

        [message]
            speaker=Jevyan
            message= _ "My eyes...! Is it normal for the sun to shine so brightly?"
        [/message]
        [message]
            speaker=Alenya
            message= _ "I'm afraid it isn't; this must be some Celestial trick..."
        [/message]
        [message]
            role=Celestial
            message= _ "Ha! This is just a small demonstration of Lord Grigorius' power: the Sacred Sky, which increases our power with the holy heavenly light!"
        [/message]
        [message]
            speaker=Myra
            message= _ "It may last only half a day, but their power increase under this light is incredible; we must choose carefully the time to attack."
        [/message]
    [/event]

    [event]
        name=turn 5

        [move_unit_fake]
            type=Hannuk Tarkan
            x=36,33
            y=1,6
            side=1
        [/move_unit_fake]

        [unstore_unit]
            variable=tarkyn7_store
            x=33
            y=6
        [/unstore_unit]

        {CLEAR_VARIABLE tarkyn7_store}
        {MODIFY_UNIT (id=Tarkyn) canrecruit yes}

        [terrain]
            x=33,34,34,33,33,32,32
            y=5,5,6,7,6,5,6
            terrain=Ce
        [/terrain]
        [terrain]
            x,y=33,6
            terrain=Ke
        [/terrain]

        [foreach]
            array = hannuk_veterans
            variable = hannuk_unit
            [do]
                {VARIABLE hannuk_unit.side 1}
                [unstore_unit]
                    variable=hannuk_unit
                    x,y=recall,recall
                [/unstore_unit]
            [/do]
        [/foreach]
        {CLEAR_VARIABLE hannuk_veterans}

        [modify_side]
            side=1
            gold=500
        [/modify_side]

        [message]
            speaker=Myra
            message= _ "Father! But... What are you doing here? Who is watching Maat'Kare? Who's taking care of..."
        [/message]
        [message]
            speaker=Tarkyn
            message=_ "The rest of the city's council is administering it, the wargs are protecting it, Aldrik is at the Academy, and I'm here because... Well, you didn't really think I would just sit there and let you have all the glory, right? I'm old, but not useless."
        [/message]
        [message]
            speaker=Myra
            message=_ "But you shouldn't..."
        [/message]
        [message]
            speaker=Tarkyn
            message=_ "Listen, who do you think you are to tell me what I should do? You may be a mighty heroine, but I'm still your father, never forget that!"
        [/message]
        [message]
            speaker=Myra
            message=_ "(chuckling) Stubborn to the end... Well then, now that you have come all the way here, then let's fight!"
        [/message]
        [message]
            speaker=Jevyan
            message=_ "A pity Ravyan is so far away... He's fought alongside us for so long, only to miss this great battle..."
        [/message]
        [message]
            speaker=Tarkyn
            message=_ "(smiles)"
        [/message]

        [objectives]
            side=1
            [objective]
                description= _ "Wait for Grigorius to rise"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Myra"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Jevyan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Alenya"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Dvalin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tarkyn"
                condition=lose
            [/objective]
            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=turn 7

        [move_unit_fake]
            type=Aragwaithi Ancient Banner
            x=11,17
            y=1,10
            side=1
        [/move_unit_fake]

        [unstore_unit]
            variable=ravyan7_store
            x=17
            y=10
        [/unstore_unit]
        {CLEAR_VARIABLE ravyan7_store}
        {MODIFY_UNIT (id=Ravyan) canrecruit yes}

        [move_unit_fake]
            type=Claimant
            x=11,16
            y=1,10
            side=1
        [/move_unit_fake]

        [unstore_unit]
            variable=liliel
            x=16
            y=10
        [/unstore_unit]

        [unhide_unit]
            id=Liliel
        [/unhide_unit]

        [terrain]
            x=16,17,18
            y=9-10,9-11,9-10
            terrain=Ce
        [/terrain]
        [terrain]
            x,y=17,10
            terrain=Ke
        [/terrain]

        [foreach]
            array = aragwaith_veterans
            variable = aragwaith_unit
            [do]
                {VARIABLE aragwaith_unit.side 1}
                [unstore_unit]
                    variable=aragwaith_unit
                    x,y=recall,recall
                [/unstore_unit]
            [/do]
        [/foreach]
        {CLEAR_VARIABLE aragwaith_veterans}

        [modify_side]
            side=1
            gold=500
        [/modify_side]

        [message]
            speaker=Ravyan
            message= _ "Did you miss me?"
        [/message]
        [message]
            speaker=Myra
            message=_ "(puzzled) But... How did you know... And what is <i>she</i> doing alongside you?"
        [/message]
        [message]
            speaker=Ravyan
            message=_ "Well, we were about to destroy Hagor's capital, when she appeared out of nowhere, begging me to hurry to help you... I took some time to believe her, but when she said Grigorius had stolen the Sky Soul, and that Akashia... Well, I talked with Eranak and the dwarves, they pledged themselves to finish the defeat of Hagor, and so we searched for you. Liliel was invaluable then, she scouted ahead of us and eventually sighted this battle..."
        [/message]
        [message]
            speaker=Myra
            message=_ "(smiling) Well, seems like you have been useful yet again, Liliel... Keep going like this, and we may even let you live with us."
        [/message]
        [message]
            speaker=Liliel
            message=_ "(smiles shyly)"
        [/message]
        [message]
            speaker=Dvalin
            message=_ "But, will you fight against your former comrades?"
        [/message]
        [message]
            speaker=Liliel
            message=_ "I now understand fully well what Zaal said that day... It pains me to do so, but, if it's to save this world from Grigorius' evil, then I yes, I will."
        [/message]
        [message]
            role=Celestial
            message=_ "The weeds always grow next to each other... It makes perfect sense that the sister of the traitor Zaal's best friend turns her blade against this glorious Tower as well! But it does not matter how many reinforcements you receive, heretics, you shall perish all te same!"
        [/message]

        [objectives]
            side=1
            [objective]
                description= _ "Wait for Grigorius to rise"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Myra"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Jevyan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Alenya"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Dvalin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tarkyn"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ravyan"
                condition=lose
            [/objective]
            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Liliel
        [/filter]

        [music]
            name=sad.ogg
            play_once=yes
        [/music]

        [message]
            speaker=Liliel
            message= _ "I receive the punishment for having been such a fool... At least I shall now be reunited with my brother and Zaal..."
        [/message]
        [message]
            speaker=Alenya
            message= _ "Rest in peace, Liliel. You have always dedicated yourself to what you deemed good, and so you didn't deserve to die like this. We shall never forget you."
        [/message]
    [/event]

    [event]
        name=turn 8

        {THUNDER_LIGHTNING}

        [unit]
            {GRIGORIUS_ASCENDED}
            side=2
            x,y=24,33
        [/unit]

        [modify_side]
            side=2
            {GOLD 1000 1150 1300}
            {INCOME 120 140 160}
        [/modify_side]

        {CAPTURE_VILLAGES 2 24 33 14}

        # This is to prevent the weird bug that causes Grigorius to recruit dwarves
        [disallow_recruit]
            side=2
            type=Dwarvish Fighter,Dwarvish Scout,Dwarvish Thunderer,Dwarvish Steelclad,Dwarvish Pathfinder,Dwarvish Thunderguard,Dwarvish Lord,Dwarvish Explorer,Dwarvish Dragonguard,Dwarvish Guardsman,Dwarvish Stalwart,Dwarvish Sentinel
        [/disallow_recruit]

        [scroll_to_unit]
            id=Grigorius
        [/scroll_to_unit]
        [delay]
            time=1000
        [/delay]

        [message]
            speaker=Grigorius
            message= _ "Myra of Hiera'Shirsha... I had planned on giving thee a chance to live peacefully, but you truly seem eager to die..."
        [/message]
        [message]
            speaker=Myra
            message=_ "Did you really think I'd not destroy you for what you have done to Akashia and my Windsong sisters? Did you really think I would simply allow Svarballi's Soul to remain in your corrupted hands?"
        [/message]
        [message]
            speaker=Grigorius
            message=_ "(smirking) Actually, I did not... In fact, I was expecting - no, I desired you to come, so that I might smite you myself and put a definitive end to your heresy!"
        [/message]
        [message]
            speaker=Alenya
            message=_ "You call us heretics and sinners, but you are the real monster! Would that we had given heed to Zaal, who first saw your true face, before!"
        [/message]
        [message]
            speaker=Grigorius
            message=_ "Zaal was an idealistic fool; he believed this world could be fixed with passive vigilance and pacifism, but the truth is, this world can only be fixed by a strong, righteous hand! <i>Mine</i> is the hand fated to bring peace and harmony to Irdya, and now there are no more foolish High Dragons to stop me!"
        [/message]
        [message]
            speaker=Myra
            message=_ "You call them foolish, but you seem unaware of how similar to Svarballi you sound..."
        [/message]
        [message]
            speaker=Grigorius
            message=_ "(in rage) Enough with useless words! Onwards, soldiers of Light! Only one obstacle stands between us and a better world, and it stands right before us!"
        [/message]

        [objectives]
            side=1
            [objective]
                description= _ "Put an end to Grigorius' insanity"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Myra"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Jevyan"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Alenya"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Dvalin"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Tarkyn"
                condition=lose
            [/objective]
            [objective]
                description= _ "Death of Ravyan"
                condition=lose
            [/objective]
            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=attack
        [filter]
            [not]
                id=Myra
            [/not]
        [/filter]
        [filter_second]
            id=Grigorius
        [/filter_second]
        [message]
            speaker=Grigorius
            message=_ "Lowly spawn of darkness, you are no match for the highest of Celestials!"
        [/message]
    [/event]

    [event]
        name=attack
        [filter]
            id=Myra
        [/filter]
        [filter_second]
            id=Grigorius
        [/filter_second]
        [message]
            speaker=Myra
            message= _ "I'm here, Grigorius! Now, FIGHT ME!"
        [/message]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Grigorius
        [/filter]
        [message]
            speaker=Grigorius
            message=_ "NO!!!"
        [/message]
        [message]
            speaker=Myra
            message=_ "This is your end, Grigorius!"
        [/message]
    [/event]

    [event]
        name=die
        [filter]
            id=Grigorius
        [/filter]
        [message]
            speaker=Jevyan
            message=_ "Yes! We are victorious!"
        [/message]
        [message]
            role=Celestial
            message=_ "No... No!!! How... How can our Lord be defeated by heretics?!"
        [/message]
        [message]
            speaker=Myra
            message=_ "Celestials! You have done us great harm, but I, in the name of the humans of Netjer-Ta, offer you the chance to..."
        [/message]

        [delay]
            time=800
        [/delay]

        [message]
            speaker=Jevyan
            message= _ "Um, the chance to...?"
        [/message]
        [message]
            speaker=Alenya
            message=_ "Myra, is everything all right?"
        [/message]
        [message]
            speaker=narrator
            message=_ "Myra did not answer; she had suddenly sensed a faint, but terrifying spark of energy coming from her back, where the formerly mighty Celestial lord still agonized... Then, she understood what was about to happen, and ran towards Grigorius to stop him, but it was too late: just as he incrusted the Soul into his breastplate, she was thrown back by a powerful explosion at the same time a spine-chilling roar echoed in the Silent Desert, and as maelstroms of an overwhelmingly evil energy surged from where the Apotheosis Seraphin had made his last stand..."
        [/message]

        {THUNDER_LIGHTNING}
        {REPLACE_SCENARIO_MUSIC March_of_the_divine.ogg}

        [message]
            speaker=Ravyan
            message=_ "W-what is happening?!"
        [/message]
        [message]
            speaker=Alenya
            message=_ "This... Oh, no, he didn't do this..."
        [/message]
        [message]
            speaker=Dvalin
            message=_ "Did what?"
        [/message]
        [message]
            speaker=Alenya
            message= _ "Grigorius is... channelling the Soul's full power... Not unleashing it, like Myra has once done, but... absorbing it..."
        [/message]

        [unit]
            {GRIGORIUS_CORRUPTED}
            side=2
            x,y=24,33
        [/unit]

        [scroll_to_unit]
            id="Corrupted Grigorius"
        [/scroll_to_unit]

        [delay]
            time=1200
        [/delay]

        [message]
            speaker=Jevyan
            message= _ "What..."
        [/message]
        [message]
            speaker=Tarkyn
            message= _ "...the hell..."
        [/message]
        [message]
            speaker=Dvalin
            message=_ "...is that thing?"
        [/message]
        [message]
            speaker=Myra
            message= _ "Grigorius, you fool! Can't you see you will destroy yourself by absorbing the Soul's power?"
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "Grigorius... is no more..."
        [/message]
        [message]
            speaker=Myra
            message= _ "What? You..."
        [/message]

        [delay]
            time=800
        [/delay]

        [message]
            speaker=Myra
            message= _ "No... No, this... This I refuse to..."
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "Come now, we have been close to each other long enough for you to recognize my aura on the spot!"
        [/message]

        [delay]
            time=600
        [/delay]

        [message]
            speaker="Corrupted Grigorius"
            message= _ "(shouting) Heed me, miserable wretches, Grigorius the Fool is no more! I am Svarballi, the Chosen of Ananke, Deliverer of this world!"
        [/message]
        [message]
            speaker=narrator
            message= _ "Everyone, from dwarves to humans to Celestials, stood still, too shocked by that revelation to speak anything. The Celestials stared at the transformed body of their former leader in utter disbelief; those who had seen Svarballi before at Garet-Desh stood appalled and terrified, but Myra, who remained on the ground after being thrown away by the explosion, to her own surprise felt a burning, growing rage inside herself. There stood the monster who had caused the Last War, the deaths of Veela and Maat, the destruction of Hiera'Shirsha and Akashia's downfall; there stood the root of all the suffering she and so many others had endured for years..."
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "It is ironic that this fool has tried to master my soul, and that it was I who mastered his... But I should thank him; after all, were it not for his foolishness, I would still be trapped within that cursed gem..."
        [/message]
        [message]
            speaker=Myra
            message= _ "(getting to her feet) Jevyan, father, Ravyan, gather all our soldiers and flee this place immediately! You stand no chance against him!"
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "...a gem created by the mother of this young girl that stands before me. I acknowledge the High Ascendant caught me off guard, but by Ananke, I will not let that happen again..."
        [/message]
        [message]
            speaker=Myra
            message= _ "You were created to protect the world of your creator's beloved, Svarballi; will you go against his will and destroy it?"
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "Ananke's will means nothing now, she no longer exists in this universe, and the same goes for all the other Avatars! This world has been abandoned, Myra of Hiera'Shirsha, and all its dwellers have been left to suffer! I have tried to put an end to their senseless existence, but fools have hindered me - but no longer! This time, there is no more Maat, no more Nitiballi..."
        [/message]

        [delay]
            time=400
        [/delay]

        [message]
            speaker="Corrupted Grigorius"
            message= _ "No, I am mistaken... Nitiballi still exists, now I can sense his energy coming from within you... Then I shall have a chance to exact revenge on both Nitiballi and Maat at once... So..."
        [/message]

        [color_adjust]
            red=100
            green=100
            blue=100
        [/color_adjust]

        {THUNDER_LIGHTNING}

        [message]
            speaker="Corrupted Grigorius"
            message= _ "...let the end BEGIN!"
        [/message]

        {THUNDER_LIGHTNING}

        [delay]
            time=600
        [/delay]

        [color_adjust]
            red=100
            green=100
            blue=100
        [/color_adjust]

        {THUNDER_LIGHTNING}

        [message]
            speaker=Myra
            message=_ "Jevyan, friends, you must leave this place immediately!"
        [/message]
        [message]
            speaker=Jevyan
            message= _ "What?! No way I'm leaving you to fight this beast alone!"
        [/message]
        [message]
            speaker=Myra
            message= _ "I SAID LEAVE THIS PLACE!"
        [/message]

        [delay]
            time=800
        [/delay]

        [message]
            speaker=Myra
            message= _ "Please, friends, do not make me see more of you dying, I... I have had enough of that..."
        [/message]

        [delay]
            time=800
        [/delay]

        [message]
            speaker=Tarkyn
            message= _ "She... She is right, Jevyan, there is nothing we can do now.."
        [/message]
        [message]
            speaker=Alenya
            message= _ "(crying) Myra..."
        [/message]
        [message]
            speaker=Myra
            message= _ "I-I am happy that I have met you all... Please, take care of Maat'Kare for me; do not let all our sacrifices be in vain..."
        [/message]

        [delay]
            time=600
        [/delay]

        {MOVE_UNIT id=Dvalin 28 1}
        [store_unit]
            [filter]
                id=Dvalin
            [/filter]
            variable=dvalin10_store
            kill=yes
        [/store_unit]

        {MOVE_UNIT id=Alenya 26 1}
        [store_unit]
            [filter]
                id=Alenya
            [/filter]
            variable=alenya9_store
            kill=yes
        [/store_unit]

        {MOVE_UNIT id=Jevyan 27 1}
        [store_unit]
            [filter]
                id=Jevyan
            [/filter]
            variable=jevyan9_store
            kill=yes
        [/store_unit]

        {MOVE_UNIT id=Ravyan 29 1}
        [store_unit]
            [filter]
                id=Ravyan
            [/filter]
            variable=ravyan9_store
            kill=yes
        [/store_unit]

        {MOVE_UNIT id=Tarkyn 25 1}
        [store_unit]
            [filter]
                id=Tarkyn
            [/filter]
            variable=tarkyn9_store
            kill=yes
        [/store_unit]

        {MOVE_UNIT id=Liliel 24 1}
        [store_unit]
            [filter]
                id=Liliel
            [/filter]
            variable=liliel3_store
            kill=yes
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                type=Scribe,Savant,Rune Forger,Arbiter,Librarian,Seeker,Pathfinder,Farstrider,Skyrunner,Stormbringer,Courier,Reaver,Dreadnought,Emissary,Envoy,Herald,Gatekeeper,Lorekeeper,Oathkeeper,Heretic,Warmonger,Water Nymph,Water Shyde
            [/filter]
            kill=yes
            variable=more_windsong_veterans
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                type=Aragwaith Spearman,Aragwaith Pikeman,Aragwaith Guardian,Aragwaith Flagbearer,Aragwaith Captain,Aragwaith Ancient Banner,Aragwaith Swordsman,Aragwaith Longswordsman,Aragwaith Swordsmaster,Aragwaith Guard,Aragwaith Shield Guard,Aragwaith Scout,Aragwaith Lancer,Aragwaith Silver Shield,Aragwaith Archer,Aragwaith Strongbow,Aragwaith Greatbow,Aragwaith Slayer
            [/filter]
            kill=yes
            variable=more_aragwaith_veterans
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                type=Hannuk Horse Archer,Hannuk Mangudai,Hannuk Tarkan,Hannuk Raider,Hannuk Conqueror,Hannuk Wood Hunter,Hannuk Sharpshooter,Hannuk Forest Bane,Hannuk Charioteer,Hannuk Scythe Charioteer,Hannuk War Charioteer
            [/filter]
            kill=yes
            variable=more_hannuk_veterans
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                type=Dwarvish Fighter,Dwarvish Steelclad,Dwarvish Lord,Dwarvish Scout,Dwarvish Pathfinder,Dwarvish Explorer,Dwarvish Thunderguard,Dwarvish Dragonguard,Dwarvish Stalwart,Dwarvish Sentinel
                [not]
                    id=Dvalin
                [/not]
            [/filter]
            kill=yes
            variable=way_more_dwarf_veterans
        [/store_unit]

        [store_unit]
            [filter]
                side=1
                type=Spearman,Pikeman,Halberdier,Swordsman,Royal Guard,Javelineer,Bladesman,Glaiver,Chevalier,Duke,Bowman,Longbowman,Master Bowman
            [/filter]
            kill=yes
            variable=maatkarian_veterans
        [/store_unit]

        [role]
            type=Celestial Herald,Sage,Divine Champion,Holy Sentinel,Prophet
            role=Celestial
        [/role]
        [message]
            role=Celestial
            message= _ "The heretics are fleeing, but we cannot abandon our dear tower to this monster! Come, soldiers of Light, let's save our dear Lord from this corrupting demon!"
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "Pathetic little beings, when will you learn to DISAPPEAR!!!"
        [/message]

        {THUNDER_LIGHTNING}

        [kill]
            race=celestial
            [not]
                id="Corrupted Grigorius"
            [/not]
            animate=yes
        [/kill]
        [kill]
            race=elemental
            animate=yes
        [/kill]

        [message]
            speaker=Grigorius
            message= _ "Now it is better, only the two of us, Myra..."
        [/message]
        [message]
            speaker=narrator
            image=portraits/nitiballi.png
            message= _ "Myra, you know what to do."
        [/message]
        [message]
            speaker=Myra
            message= _ "I have known that since the Fountain of Life..."
        [/message]

        [delay]
            time=600
        [/delay]

        [message]
            speaker=Myra
            message= _ "*Spirits of Nature, before me stands the Destroyer, the enemy of all life; please, grant me the power to stop him, use my body as your vessel, let your power flow through me!*"
        [/message]

        [sound]
            name=magic-faeriefire.ogg
        [/sound]

        [object]
            id=nature_avatar
            duration=forever
            silent=yes
            [filter]
                id=Myra
            [/filter]
            [effect]
                apply_to=type
                name=Avatar of Nature
            [/effect]
        [/object]

        {MODIFY_UNIT id=Myra profile "portraits/myra-avatar.png"}

        [heal_unit]
            [filter]
                id=Myra
            [/filter]
            amount=full
            moves=full
            restore_attacks=yes
            restore_statuses=yes
        [/heal_unit]

        [delay]
            time=1600
        [/delay]

        [message]
            speaker="Corrupted Grigorius"
            message= _ "Interesting... As expected, you can channel Nature's power as well as Nitiballi himself... (smirking) Not that it will change the outcome of this battle, though..."
        [/message]
        [message]
            speaker=Myra
            message= _ "We'll see about that, Sky Dragon...!"
        [/message]

        [disallow_recruit]
            side=1
            type=Ethereal Wisp,Brazier Imp,Furnace Beast,Sylph,Zephyr,Tidal,Ice Crab,Vine Beast,Vine Tiger,Kobold,Stone Golem,Razorbird,Thunderbird,Undine
        [/disallow_recruit]

        [objectives]
            side=1
            [objective]
                description= _ "Defeat the awakened Svarballi, even if that costs your life"
                condition=win
            [/objective]
            [objective]
                description= _ "Death of Myra"
                condition=lose
            [/objective]
            [gold_carryover]
                carryover_percentage=0
            [/gold_carryover]
        [/objectives]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Myra
        [/filter]

        # This is just so that this event won't be triggered if Myra dies before Svarballi's awakening

        [if]
            [have_unit]
                id="Corrupted Grigorius"
            [/have_unit]
            [then]
                [message]
                    speaker=Myra
                    message= _ "Aaargh!!!"
                [/message]
                [message]
                    speaker=narrator
                    image=portraits/nitiballi.png
                    message= _ "Myra, please resist!"
                [/message]
                [message]
                    speaker="Corrupted Grigorius"
                    message= _ "I have warned you, I would not commit the same mistakes again! Do you see now how much more powerful I am? Do you see now that there is no hope for your victory?"
                [/message]
                [message]
                    speaker=Myra
                    message= _ "No, Svarballi..."
                [/message]
                [message]
                    speaker=Myra
                    message= _ "As long as there is life..."
                [/message]
                [message]
                    speaker=Myra
                    message= _ "...as long as there is love and a heart that seeks justice..."
                [/message]
                [message]
                    speaker=Myra
                    message= _ "...there is hope."
                [/message]

                [sound]
                    name=magic-faeriefire.ogg
                    repeat=2
                [/sound]

                [message]
                    speaker=narrator
                    image=portraits/nitiballi.png
                    message= _ "Myra..."
                [/message]
                [message]
                    speaker=Myra
                    message= _ "*Do not lecture me, you've done that once too...*"
                [/message]

                {REPLACE_SCENARIO_MUSIC fragments_of_time_cut.ogg}

                [sound]
                    name=magic-faeriefire.ogg
                    repeat=3
                [/sound]

                [object]
                    id=nature_avatar_ultra
                    duration=forever
                    silent=yes
                    [filter]
                        id=Myra
                    [/filter]
                    [effect]
                        apply_to=type
                        name=Avatar of Nature Extreme
                    [/effect]
                [/object]

                {MODIFY_UNIT id=Myra profile "portraits/myra-avatar-ultimate.png"}

                [heal_unit]
                    [filter]
                        id=Myra
                    [/filter]
                    amount=full
                    moves=full
                    restore_attacks=yes
                    restore_statuses=yes
                [/heal_unit]

                [message]
                    speaker="Corrupted Grigorius"
                    message= _ "Stubborn wretch, why do you insist on living this miserable existence? When will learn to just give up and DIE?!"
                [/message]
                [message]
                    speaker=Myra
                    message= _ "Never. Now, let's end this, Svarballi!"
                [/message]

                [objectives]
                    side=1
                    [objective]
                        description= _ "Put an end to Svarballi's menace"
                        condition=win
                    [/objective]
                    [objective]
                        description= _ "Death of Myra"
                        condition=lose
                    [/objective]
                    [gold_carryover]
                        carryover_percentage=0
                    [/gold_carryover]
                [/objectives]
            [/then]
        [/if]
    [/event]

    [event]
        name=last breath
        [filter]
            id="Corrupted Grigorius"
        [/filter]

        [message]
            speaker="Corrupted Grigorius"
            message= _ "You helpless fool, you are killing yourself, and for what? This is far from being enough to kill me!"
        [/message]
        [message]
            speaker=Myra
            message= _ "I can't... kill you... but I can... keep you locked... until the one... who can do that... comes..."
        [/message]
        [message]
            speaker="Corrupted Grigorius"
            message= _ "You may have managed to lock me again, but know that Grigorius was not the last fool who will find and unleash my soul! And, when this happens again, you will not be here to stop me!"
        [/message]
        [message]
            speaker=Myra
            message= _ "I... won't... but... every... era... has... its... heroes..."
        [/message]
        [message]
            speaker=Myra
            message= _ "*...right, Nitiballi?*"
        [/message]
        [message]
            speaker=narrator
            image=portraits/nitiballi.png
            message= _ "(glad) I knew I was right in choosing you, my child. I am so proud of you."
        [/message]
        [message]
            speaker=Myra
            message= _ "*As I am for having been with you, Water Dragon*"
        [/message]
        [message]
            speaker=narrator
            image=portraits/nitiballi.png
            message= _ "You have fought hard and for a long time; you have bled and suffered, and faced all kinds of perils; but you have overcome them all to save your people. Now, Myra of Hiera'Shirsha, let us rest in peace; we both deserve it..."
        [/message]

        [color_adjust]
            red=25
            green=25
            blue=25
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [color_adjust]
            red=50
            green=50
            blue=50
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [color_adjust]
            red=75
            green=75
            blue=75
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [color_adjust]
            red=100
            green=100
            blue=100
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [color_adjust]
            red=125
            green=125
            blue=125
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [color_adjust]
            red=150
            green=150
            blue=150
        [/color_adjust]
        [delay]
            time=100
        [/delay]

        [endlevel]
            result=victory
            bonus=no
            carryover_report=no
            linger_mode=no
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Myra
        [/filter]
        [if]
            [not]
                [have_unit]
                    id="Corrupted Grigorius"
                [/have_unit]
            [/not]
            [then]
                [message]
                    speaker=Myra
                    message= _ "T have fought so much, only to fall at the end..."
                [/message]
                [endlevel]
                    result=defeat
                [/endlevel]
            [/then]
        [/if]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Jevyan
        [/filter]
        [message]
            speaker=Jevyan
            message= _ "No... Myra, I-"
        [/message]
        [message]
            speaker=Myra
            message= _ "Jevyan! No, you can't die now... NO!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Alenya
        [/filter]
        [message]
            speaker=Alenya
            message= _ "Aaahhh!!!"
        [/message]
        [message]
            speaker=Dvalin
            message= _ "ALENYA, NO!!!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Dvalin
        [/filter]
        [message]
            speaker=Dvalin
            message= _ "Aarrgh!!! Sorry, Alenya, I've failed you..."
        [/message]
        [message]
            speaker=Alenya
            message= _ "DVALIN, NO!!!"
        [/message]

        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Ravyan
        [/filter]
        [message]
            speaker=Ravyan
            message= _ "I have failed in protecting Maat'Kare..."
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]

    [event]
        name=last breath
        [filter]
            id=Tarkyn
        [/filter]
        [message]
            speaker=Tarkyn
            message= _ "Argh! My days are ended; farewell, friends..."
        [/message]
        [message]
            speaker=Myra
            message= _ "Father, no! Please, don't die, Aldrik needs you...!"
        [/message]
        [endlevel]
            result=defeat
        [/endlevel]
    [/event]
[/scenario]
